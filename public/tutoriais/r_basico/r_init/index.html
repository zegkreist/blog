<!DOCTYPE html>
<html lang="pt-br">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Navarro Rosa">

  
  
  
    
  
  <meta name="description" content="R - Básico R em Container Agora que já se sabe como subir imagens de docker, vamos subir uma de R studio server com vários pacotes instalados para poder praticar.
CASO NÃO QUEIRA PASSAR POR ISSO/ JÁ TEM UMA VERSÃO DO R INSTALADA E APENAS QUER VER UNS COMANDINHOS PULE PARA PROCESSA ETAMA (OLHE O TABLE OF CONTENTS DO LADO DIREITO)
Primeiro, vamos criar uma pasta de trabalho para o docker-compose.">

  
  <link rel="alternate" hreflang="pt-br" href="../../../tutoriais/r_basico/r_init/">

  


  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="../../../css/academic.min.dd629241ea9333c62c071f4a25f829ff.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-148080553-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="../../../index.webmanifest">
  <link rel="icon" type="image/png" href="../../../img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../img/icon-192.png">

  <link rel="canonical" href="../../../tutoriais/r_basico/r_init/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@zegkreist">
  <meta property="twitter:creator" content="@zegkreist">
  
  <meta property="og:site_name" content="Vugudum">
  <meta property="og:url" content="/tutoriais/r_basico/r_init/">
  <meta property="og:title" content="R basicão | Vugudum">
  <meta property="og:description" content="R - Básico R em Container Agora que já se sabe como subir imagens de docker, vamos subir uma de R studio server com vários pacotes instalados para poder praticar.
CASO NÃO QUEIRA PASSAR POR ISSO/ JÁ TEM UMA VERSÃO DO R INSTALADA E APENAS QUER VER UNS COMANDINHOS PULE PARA PROCESSA ETAMA (OLHE O TABLE OF CONTENTS DO LADO DIREITO)
Primeiro, vamos criar uma pasta de trabalho para o docker-compose."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="pt-br">
  
    
      <meta property="article:published_time" content="2019-12-20T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-12-20T00:00:00&#43;00:00">
  

  


  





  <title>R basicão | Vugudum</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="../../../">Vugudum</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="../../../tutoriais/"><span>Tutoriais</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="../../../#contact"><span>contato</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="../../../tutoriais/r_basico/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="../../../tutoriais/r_basico/r_init/">R Básico</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="../../../tutoriais/r_basico/r_init/">R - Básico (para padawans)</a>
      </li>
      
      <li >
        <a href="../../../tutoriais/r_basico/r_datatable/">R - Data table</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
<ul>
<li><a href="#r-básico">R - Básico</a>
<ul>
<li><a href="#r-em-container">R em Container</a></li>
<li><a href="#objetos">Objetos</a>
<ul>
<li><a href="#vetores">Vetores</a></li>
<li><a href="#matrizes">Matrizes</a></li>
<li><a href="#data-frame">Data-frame</a></li>
<li><a href="#listas">Listas</a></li>
</ul></li>
<li><a href="#tipos">Tipos</a></li>
<li><a href="#operações">Operações</a>
<ul>
<li><a href="#hail-to-all-mighty-pipe">HAIL to all mighty PIPE</a></li>
<li><a href="#filtros-e-subsets">Filtros e subsets</a></li>
</ul></li>
<li><a href="#laços">Laços</a>
<ul>
<li><a href="#for">For</a></li>
<li><a href="#while">While</a></li>
</ul></li>
<li><a href="#if-or-else">IF &hellip; or ELSE!!</a></li>
<li><a href="#funções">Funções</a></li>
<li><a href="#loading-75">Loading |======&mdash;| 75%</a>
<ul>
<li><a href="#csv-e-txt">CSV e TXT</a></li>
<li><a href="#leitura-do-banco-de-dados">Leitura do banco de dados</a></li>
</ul></li>
</ul></li>
</ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article" itemscope itemtype="http://schema.org/Article">

        <div class="docs-article-container">
          <h1 itemprop="name">R basicão</h1>

          <div class="article-style" itemprop="articleBody">
            

<h1 id="r-básico">R - Básico</h1>

<hr />

<h2 id="r-em-container">R em Container</h2>

<p>Agora que já se sabe como subir imagens de docker, vamos subir uma de R studio server com vários pacotes instalados para poder praticar.</p>

<hr />

<p><code>CASO NÃO QUEIRA PASSAR POR ISSO/ JÁ TEM UMA VERSÃO DO R INSTALADA E APENAS QUER VER UNS COMANDINHOS PULE PARA PROCESSA ETAMA (OLHE O TABLE OF CONTENTS DO LADO DIREITO)</code></p>

<hr />

<p>Primeiro, vamos criar uma pasta de trabalho para o <code>docker-compose.yml</code> que iremos utilizar (assumindo que estamos num Linux, caso não esteja faça como achar melhor no seu sistema).</p>

<pre><code class="language-sh">mkdir /home/${USER}/docker_compose_rstudio
</code></pre>

<p>Vamos viajar lá para dentro.</p>

<pre><code class="language-sh">cd /home/${USER}/docker_compose_rstudio
</code></pre>

<p>Agora vamos criar uma pasta persistente para montarmos dentro do container. (Caso queira saber mais sobre isso olhe o tutorialzinho de docker que eu fiz, também aqui no VUGUDUM)</p>

<pre><code class="language-sh">mkdir /home/${USER}/Projetos_R
</code></pre>

<p>Criar um arquivo <code>docker-compose.yml</code> já com tudo dentro <strong>(Coloque uma senha melhor para sua pessoa).</strong> Esta imagem <code>zegkreist/r-dl-cpu</code> foi criada por mim, ela possui quase tudo que um cientista de dados precisa (por isso ela é gigante ~ 9GB, caso queira outra com RStudio se sinta tranquilo para fazer o que você &ldquo;querÊ&rdquo;)</p>

<pre><code class="language-sh">echo &quot;
version: '2'
services:
  r-dl-cpu_teste:
    image: zegkreist/r-dl-cpu
    container_name: r_server_1
    restart: always
    environment:
     - USER=$USER
     - USERID=1000
     - PASSWORD=123facil
    ports:
     - &quot;8787:8787&quot;
    volumes:
     - /home/${USER}/Projetos_R:/home/teste/Projetos_R:rw &quot; &gt; /home/${USER}/docker_compose_rstudio/docker-compose.yml
</code></pre>

<p>Suba o serviço do rstudio server utilizando o <code>docker-compose</code></p>

<pre><code class="language-sh">docker-compose up -d
</code></pre>

<p>Acesse em <a href="http://127.0.0.1:8787" target="_blank">http://127.0.0.1:8787</a> se for na sua máquina local ou <a href="http://ip_da_sua_instancia:8787" target="_blank">http://ip_da_sua_instancia:8787</a>. O login será seu usuário (rode <code>echo $USER</code> no console para descobrir) e a senha será a que você escolheu. Caso esteja numa instância remota que fique claro que a conexão aqui é apenas HTTP, para transforma-la em HTTPS precisa fazer um rolê aí que não irei explicar aqui, pois não é o foco.</p>

<p>Sua pessoa chegará numa tela parecida com essa.</p>

<p><img src="rstudio_server_entrada.png" alt="GUI do Rstudio" /></p>

<p>Observe que há 4 áreas principais</p>

<ul>
<li>Source: onde está o editor de códigos e arquivos txt</li>
<li>Environment/History/Conn/Git: Onde mostra os objetos declarados (há também outras abas, como history dos comandos rodados, connections, git, etc)</li>
<li>Console: Onde os script são executados (há também outras abas, como terminal em que você pode executar comandos no console do seu OS, <strong>como estamos dentro de um serviço em container este terminal é sobre o OS do container, um Debian</strong>)</li>
<li>Files/Packages/Plot/Help: Aqui está uma espécie de &lsquo;navegador&rsquo;, você pode olhar os arquivos nas pastas vizinhas, olhar as figuras geradas pelo R, usar o Help para pesquisa de comandos, etc.</li>
</ul>

<p>Antes de começarmos a praticar vamos criar um projeto. Um projeto no R possui um work directory, seta o &ldquo;home&rdquo; do projeto como este work directory, salva o histórico de códigos rodados neste projeto, facilita commit utilizando o git, assim como o push para o repositório. Então, <strong>SEMPRE</strong> faça as coisas dentro de um projeto, melhor organização  ..  melhor código.</p>

<p>Vamos criar uma pasta para o projeto, navegue para dentro da pasta <code>Projetos_R</code> clique em <code>New Folder</code> e crie uma nova paste com o nome do projeto, pode ser <code>inicio</code>.</p>

<p><img src="new_folder.png" alt="Local para criar a nova pasta" /></p>

<p><img src="nome_folder.png" alt="Nome do folder" /></p>

<p>Agora vamos criar um novo projeto nesta pasta, para isso vá no canto direito superior em:</p>

<p><img src="novo_projeto.png" alt="E clique new project" /></p>

<p>Clique em diretório já existente e selecione a pasta
<img src="novo_projeto_2.png" alt="Novo Projeto" /></p>

<p>E CRIE SEU PROJETOOO!</p>

<p><img src="novo_projeto_3.png" alt="Projetinho" />
<br></p>

<p>Pronto, estamos dentro de um projeto mais organizado e controlado, todo script que salvar será nessa sua pasta criada. Vamos iniciar um novo script, no canto esquerdo superior há um sinal de positivo em verde sobre uma folha branca, clique nele e vá em Rscript.</p>

<p><img src="novo_script.png" alt="" /></p>

<p>Agora podemos começar a brincar com o R!!!!</p>

<hr />

<h2 id="objetos">Objetos</h2>

<hr />

<p>O R é uma linguagem funcional, tudo e qualquer coisa no R é uma chamada de função, porém algumas coisas podem ser vistas como objetos, são elas:</p>

<ul>
<li>Vetor</li>
<li>Matriz</li>
<li>Data-frame</li>
<li>Lista</li>
</ul>

<p>Há pacotes que possuem versões alternativas desses objetos como veremos mais a frente, mas veremos o que está no base por enquanto.</p>

<hr />

<h3 id="vetores">Vetores</h3>

<hr />

<p>O vetor é um array de uma dimensão, ou uma matriz <code>\(1 \times n\)</code>. Há várias formas de declarar um vetor. Podemos declarar numeric, integer, character, date, int64, etc, veja algumas delas:</p>

<p>Diretamente.</p>

<pre><code class="language-r">a &lt;- c(1,2,3,4)
a
</code></pre>

<pre><code>## [1] 1 2 3 4
</code></pre>

<p>Usando uma sequência que pula de um em um.</p>

<pre><code class="language-r">a &lt;- 1:4
a
</code></pre>

<pre><code>## [1] 1 2 3 4
</code></pre>

<p>Usando a função de sequência informando a quantidade que deve ser pulado.</p>

<pre><code class="language-r">a &lt;- seq(1, 4, by = 1)
a
</code></pre>

<pre><code>## [1] 1 2 3 4
</code></pre>

<p>Usando uma função que repete um determinado valor <code>\(n\)</code> vezes.</p>

<pre><code class="language-r">a &lt;- rep(1, 10)
a
</code></pre>

<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1
</code></pre>

<pre><code class="language-r">b &lt;- rep(&quot;eita&quot;, 3)
b
</code></pre>

<pre><code>## [1] &quot;eita&quot; &quot;eita&quot; &quot;eita&quot;
</code></pre>

<p>A primeira posição do vetor é <code>1</code> e usamos a função <code>[</code>.</p>

<pre><code class="language-r">a &lt;- 1:10

#primeira posicao
a[1]
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="language-r">#ultima posicao
a[length(a)]
</code></pre>

<pre><code>## [1] 10
</code></pre>

<pre><code class="language-r">#as primeiras 4 posicoes
a[1:4]
</code></pre>

<pre><code>## [1] 1 2 3 4
</code></pre>

<pre><code class="language-r">b &lt;- LETTERS
b[1:10]
</code></pre>

<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot;
</code></pre>

<pre><code class="language-r">#output de length(a)
length(a)
</code></pre>

<pre><code>## [1] 10
</code></pre>

<hr />

<h3 id="matrizes">Matrizes</h3>

<hr />

<p>Assim como no C++ uma matriz pode ser vista como um vetor de vetores de mesmo tamanho. No R a matriz deve ser apenas de um tipo, ou seja, todas as colunas devem ser do mesmo tipo, como numeric, character, etc. Para declarar uma matriz primeiro e necessário declarar um vetor e reposicioná-lo com a função matrix. Por exemplo:</p>

<pre><code class="language-r">vetor_inicial &lt;- 1:9

matriz &lt;- matrix(data = vetor_inicial,
                 ncol = 3,
                 byrow = T
                 )

matriz
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9
</code></pre>

<ul>
<li><code>data</code>: Informo o vetor que será reposicionado</li>
<li><code>ncol</code>: informo quantas colunas a matriz terá</li>
<li><code>byrow</code>: informo como será a distribuição</li>
</ul>

<p>Se fizermos com <code>byrow = F</code> temos:</p>

<pre><code class="language-r">matriz &lt;- matrix(data = vetor_inicial,
                 ncol = 3,
                 byrow = F
                 )

matriz
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
</code></pre>

<p>Para sabermos a dimensão da matriz basta utilizar <code>dim(matriz)</code>.
O modo de acesso é semelhante ao vetor, utilizando a função <code>[</code>.</p>

<pre><code class="language-r">#primeira posicao
matriz[1,1]
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="language-r">#segunda posicao
matriz[1,2]
</code></pre>

<pre><code>## [1] 4
</code></pre>

<pre><code class="language-r">#primeira linha
matriz[1,]
</code></pre>

<pre><code>## [1] 1 4 7
</code></pre>

<pre><code class="language-r">#primeira coluna
matriz[,1]
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<p>Podemos ainda nomear as colunas ou linhas e chamá-las pelo nome, veja:</p>

<pre><code class="language-r">colnames(matriz) &lt;- c(&quot;primeira&quot;, &quot;segunda&quot;, &quot;terceira&quot;)

matriz[,&quot;primeira&quot;]
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<pre><code class="language-r">#ou ainda um conjunto de colunas

matriz[, c(&quot;primeira&quot;, &quot;segunda&quot;)]
</code></pre>

<pre><code>##      primeira segunda
## [1,]        1       4
## [2,]        2       5
## [3,]        3       6
</code></pre>

<p>Repare que, eu declarei um vetor de nomes <code>c(&quot;primeira&quot;, &quot;segunda&quot;)</code> dentro do local de definição das colunas, eu poderia ter feito anteriormente, veja:</p>

<pre><code class="language-r">subset_c &lt;- c(&quot;primeira&quot;, &quot;segunda&quot;)
matriz[, subset_c]
</code></pre>

<pre><code>##      primeira segunda
## [1,]        1       4
## [2,]        2       5
## [3,]        3       6
</code></pre>

<hr />

<h3 id="data-frame">Data-frame</h3>

<hr />

<p>O data-frame é um &lsquo;objeto&rsquo; semelhante à uma matriz, porém necessita de ter as colunas nomeadas. Cada coluna é um vetor independente do outro, podendo assim ser de tipos diferentes. Há também formas diferentes de acesso ao data-frame.</p>

<p>Vamos declarar um data-frame para podermos explorá-lo.</p>

<pre><code class="language-r">dados &lt;- data.frame(id      = 1:10, #integer
                    letras  = LETTERS[1:10], #character factor
                    numeros = runif(n = 10, min = 1, max = 100) #numeric
                    )
head(dados)
</code></pre>

<pre><code>##   id letras  numeros
## 1  1      A 98.08171
## 2  2      B 43.00829
## 3  3      C 26.86298
## 4  4      D 40.94583
## 5  5      E 16.11603
## 6  6      F 48.42628
</code></pre>

<p>Podemos acessar o data-frame de forma semelhante à matriz, veja:</p>

<pre><code class="language-r">dados[1,] # Primeira linha
</code></pre>

<pre><code>##   id letras  numeros
## 1  1      A 98.08171
</code></pre>

<pre><code class="language-r">dados[,1] # Primeira coluna
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<pre><code class="language-r">dados[, &quot;letras&quot;] #coluna letras
</code></pre>

<pre><code>##  [1] A B C D E F G H I J
## Levels: A B C D E F G H I J
</code></pre>

<pre><code class="language-r">#podemos acessar ainda utilizando o operador $, veja:

dados$letras # Desta forma acessamos o vetor diretamente
</code></pre>

<pre><code>##  [1] A B C D E F G H I J
## Levels: A B C D E F G H I J
</code></pre>

<hr />

<h3 id="listas">Listas</h3>

<hr />

<p>As listas são contêineres que podem guardar qualquer tipo de objeto do R em seus slots, seria quase uma espécie de JSON (ou <code>map</code> em outras linguagens). Veja a seguinte declaração:</p>

<pre><code class="language-r">lista &lt;- list(
  primeira_pos = 1:3,
  segunda_pos  = data.frame(col_1 = 1:10),
  terceira_pos = list(
    inception = &quot;YEAH&quot;
  )
)
</code></pre>

<p>Vamos acessar seus conteúdos. Basicamente utilizaremos a função <code>[[</code> e o operador (que também é uma função) <code>$</code>.</p>

<pre><code class="language-r">lista[&quot;primeira_pos&quot;]
</code></pre>

<pre><code>## $primeira_pos
## [1] 1 2 3
</code></pre>

<pre><code class="language-r"># os seguintes abaixo sao equivalentes
lista[[1]] # vetor de fato
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<pre><code class="language-r">lista$primeira_pos # vetor de fato
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<p>Agora, navegando pelo data.frame da segunda posição.</p>

<pre><code class="language-r">#acessando primeira coluna do data.frame armazenado na lista
lista[[2]]$col_1
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<pre><code class="language-r">lista[[&quot;segunda_pos&quot;]]# data.frame
</code></pre>

<pre><code>##    col_1
## 1      1
## 2      2
## 3      3
## 4      4
## 5      5
## 6      6
## 7      7
## 8      8
## 9      9
## 10    10
</code></pre>

<pre><code class="language-r">lista$segunda_pos # data.frame
</code></pre>

<pre><code>##    col_1
## 1      1
## 2      2
## 3      3
## 4      4
## 5      5
## 6      6
## 7      7
## 8      8
## 9      9
## 10    10
</code></pre>

<pre><code class="language-r">lista$segunda_pos$col_1 # primeira coluna do data.frame
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<pre><code class="language-r">lista$segunda_pos$col_1 # primeira coluna do data.frame
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<p>Agora acessando a lista dentro da lista.</p>

<pre><code class="language-r">lista$terceira_pos # lista segundo nivel
</code></pre>

<pre><code>## $inception
## [1] &quot;YEAH&quot;
</code></pre>

<pre><code class="language-r">lista[[&quot;terceira_pos&quot;]][[&quot;inception&quot;]] # resultado da lista segundo nivel
</code></pre>

<pre><code>## [1] &quot;YEAH&quot;
</code></pre>

<pre><code class="language-r">lista[[&quot;terceira_pos&quot;]]$inception # resultado da lista segundo nivel
</code></pre>

<pre><code>## [1] &quot;YEAH&quot;
</code></pre>

<pre><code class="language-r">lista$terceira_pos$inception # resultado da lista segundo nivel
</code></pre>

<pre><code>## [1] &quot;YEAH&quot;
</code></pre>

<hr />

<h2 id="tipos">Tipos</h2>

<hr />

<p>No R temos basicamente <code>numeric</code> (seria um float), <code>integer</code>, <code>character</code>, <code>factor</code> (um tipo especial de <code>character</code>), <code>posix</code>/ <code>date</code> (um tipo especial de <code>character</code>), <code>logical</code>, <code>complex</code>. Existem alguns pacotes do R que expandem os tipos, adicionando coisas como <code>int64</code> por exemplo. Com a função <code>class</code> é possível observar o tipo de variáveis, vejamos alguns exemplos:</p>

<pre><code class="language-r">require(lubridate) # pacote que adiciona tipo date
</code></pre>

<pre><code>## Loading required package: lubridate
</code></pre>

<pre><code>## 
## Attaching package: 'lubridate'
</code></pre>

<pre><code>## The following object is masked from 'package:base':
## 
##     date
</code></pre>

<pre><code class="language-r">a &lt;- .1
b &lt;- 1L
c &lt;- 'eita'
d &lt;- &quot;Eita&quot;
e &lt;- factor(c('a','b',&quot;c&quot;,&quot;D&quot;))
f &lt;- Sys.time()
g &lt;- 1+1i
h &lt;- c(T,F, TRUE, FALSE)
i &lt;- c(1,2,&quot;a&quot;,T) # CUIDADO PARA NÃO MISTURAR OS TIPOS
j &lt;- c(1,2,T,F)   # CUIDADO PARA NÃO MISTURAR OS TIPOS
l &lt;- lubridate::as_date(Sys.time())


 cat(paste0(c(&quot;Tipo: a &quot;, class(a), &quot;\n&quot;, 
              &quot;Tipo: b &quot;, class(b), &quot;\n&quot;, 
              &quot;Tipo: c &quot;, class(c), &quot;\n&quot;, 
              &quot;Tipo: d &quot;, class(d), &quot;\n&quot;, 
              &quot;Tipo: e &quot;, class(e), &quot;\n&quot;, 
              &quot;Tipo: f &quot;, class(f), &quot;\n&quot;, 
              &quot;Tipo: g &quot;, class(g), &quot;\n&quot;, 
              &quot;Tipo: h &quot;, class(h), &quot;\n&quot;,
              &quot;Tipo: i &quot;, class(i), &quot;\n&quot;,
              &quot;Tipo: j &quot;, class(j), &quot;\n&quot;,
              &quot;Tipo: l &quot;, class(l), &quot;\n&quot;
              ),
            collapse = &quot; &quot;
            )
     )
</code></pre>

<pre><code>## Tipo: a  numeric 
##  Tipo: b  integer 
##  Tipo: c  character 
##  Tipo: d  character 
##  Tipo: e  factor 
##  Tipo: f  POSIXct POSIXt 
##  Tipo: g  complex 
##  Tipo: h  logical 
##  Tipo: i  character 
##  Tipo: j  numeric 
##  Tipo: l  Date
</code></pre>

<hr />

<h2 id="operações">Operações</h2>

<hr />

<p>No R podemos fazer as operações básicas <code>+-*/^</code>, mas também há outras como <code>%*%</code>, <code>%%</code> e <code>%in%</code> e até mesmo filtros (que aqui estou chamando de operações).</p>

<p>Os seguintes <code>+-*/^</code> tem caráter de operação escalar, veja os exemplos:</p>

<pre><code class="language-r">a &lt;- c(1,2,3,4)
b &lt;- c(2,2,2,2)

1+1 # escalar 
</code></pre>

<pre><code>## [1] 2
</code></pre>

<pre><code class="language-r">10*5 # escalar
</code></pre>

<pre><code>## [1] 50
</code></pre>

<pre><code class="language-r">2^4 #escalar
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="language-r">a*2 # escalar
</code></pre>

<pre><code>## [1] 2 4 6 8
</code></pre>

<pre><code class="language-r">a/2 # escalar
</code></pre>

<pre><code>## [1] 0.5 1.0 1.5 2.0
</code></pre>

<pre><code class="language-r">a^2 # escalar
</code></pre>

<pre><code>## [1]  1  4  9 16
</code></pre>

<pre><code class="language-r">a*b #escalar
</code></pre>

<pre><code>## [1] 2 4 6 8
</code></pre>

<pre><code class="language-r">a+b #escalar
</code></pre>

<pre><code>## [1] 3 4 5 6
</code></pre>

<pre><code class="language-r">a^2 # escalar
</code></pre>

<pre><code>## [1]  1  4  9 16
</code></pre>

<p>O operador <code>%%</code> é o resto de uma divisão, e <code>%/%</code> a parte inteira de uma divisão, então:</p>

<pre><code class="language-r">4%%3
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="language-r">4%%2
</code></pre>

<pre><code>## [1] 0
</code></pre>

<pre><code class="language-r">7%/%2
</code></pre>

<pre><code>## [1] 3
</code></pre>

<pre><code class="language-r">10%/%2
</code></pre>

<pre><code>## [1] 5
</code></pre>

<p>O operador <code>%*%</code> é a multiplicação de matrizes.</p>

<pre><code class="language-r">A &lt;- matrix(c(1:9), ncol = 3, byrow = T)
B &lt;- matrix(c(1:9), ncol = 3, byrow = F)

A%*%B # Multiplicacao de matriz
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   14   32   50
## [2,]   32   77  122
## [3,]   50  122  194
</code></pre>

<pre><code class="language-r">A+B # soma escalar
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]    2    6   10
## [2,]    6   10   14
## [3,]   10   14   18
</code></pre>

<pre><code class="language-r">A*B # multiplicacao escalar
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]    1    8   21
## [2,]    8   25   48
## [3,]   21   48   81
</code></pre>

<pre><code class="language-r">A^2 # potencia escalar
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    9
## [2,]   16   25   36
## [3,]   49   64   81
</code></pre>

<pre><code class="language-r">A%*%A #potencia matricial
</code></pre>

<pre><code>##      [,1] [,2] [,3]
## [1,]   30   36   42
## [2,]   66   81   96
## [3,]  102  126  150
</code></pre>

<hr />

<h3 id="hail-to-all-mighty-pipe">HAIL to all mighty PIPE</h3>

<hr />

<p>O R possui um operador peculiar provindo de um pacote chamado <code>magrittr</code>. Ele oferece uma facilidade viciante, por isso ficou tão popular que é comum quando um novo pacote está sendo feito para o R os autores implementam as features necessárias para que o pipe também seja utilizado em conjunto com suas funções. Como dito anteriormente, tudo no R é uma função, e estas funções podem ser redefinidas, podemos inclusive trocar os significados dos operados <code>+-*/</code>, mas isto seria besteira.</p>

<p>O pipe é um operador que faz o seguinte: <code>lhs %&gt;%  lhs</code>, seu comportamento é passar o <code>lhs</code> para ser avaliado em <code>lhs</code>. Então, seja <code>x</code> algum objeto e <code>foo</code> uma função, assim <code>x %&gt;% f</code> é equivalente a <code>f(x)</code>. Caso <code>f</code> necessite múltiplos argumentos, o comportamento padrão é que o objeto <code>x</code> seja colocado na primeira posição de <code>f</code>, ou seja, <code>x %&gt;% f(y)</code> é equivalente a <code>f(x,y)</code>. Podemos escolher a posição que será inserido da seguinte forma <code>x %&gt;% f(y, .)</code> é equivalente a <code>f(y,x)</code>.</p>

<p>Mas por que o pipe é tão utilizado? Imagine que tenhamos um objeto <code>x</code>e necessitamos de fazer várias operações encadeadas, o pipe permite que o código fique mais organizado. EXEMPLO:</p>

<p>Vamos criar um vetor <code>x</code>, calcular seu comprimento e calcular a média de uma amostra aleatória de mesmo tamanho. É um exemplo bobo, mas já ilustra o potencial da criança.</p>

<pre><code class="language-r">x &lt;- 1:100

#modo 1
n &lt;- length(x)
result &lt;- sample(1000, size = n)
result &lt;- mean(result)

#modo 2
result &lt;- sample(1000, size = length(x))
result &lt;- mean(result)

#modo 3
result &lt;- mean(sample(1000, size = length(x)))
# THE KING

result &lt;- x %&gt;% 
  length() %&gt;% 
  sample(1000, size = .) %&gt;% 
  mean()
</code></pre>

<p>Observe que utilizando o pipe, o código basicamente vira um bullet de uma apresentação de slide, a leitura é direta. Vou colocar um exemplo de código aqui embaixo, veja que não explicarei nada do código, esta apostila é para iniciante na linguagem (então suponho que não está familiarizado com o R) e mesmo assim terá uma capacidade alta de compreensão do que está sendo feito.</p>

<p>Seja <code>dados</code> um conjunto de dados qualquer.</p>

<pre><code class="language-r">result &lt;- dados %&gt;% 
  dplyr::filter(ano &gt;= &quot;2018-01-01&quot;) %&gt;% 
  dplyr::group_by(CodProcedimento) %&gt;% 
  dplyr::summarise(media = mean(ValorUtilizacao))
</code></pre>

<p>Apenas leia, é literalmente uma receita de bolo.</p>

<ul>
<li><p>Pegue dados</p></li>

<li><p>Filtre para ano &gt;= &ldquo;2018-01-01&rdquo;</p></li>

<li><p>Agrupe por CodProcedimento</p></li>

<li><p>Calcule a média do Valor Utilização</p></li>
</ul>

<p>Vamos reescrever isso de um jeito <strong>nojento</strong>.</p>

<pre><code class="language-r">result &lt;- dplyr::summarise(dplyr::group_by(dplyr::filter(dados,
                                                         ano &gt;= &quot;2018-01-01&quot;),
                                           CodProcedimento),
                           media = mean(ValorUtilizacao)
                           )
</code></pre>

<p>É bem fácil de entender até a parte do <code>dplyr::summarise</code>, depois disso&hellip;</p>

<p>Porém não iremos utilizar o pacote <code>dplyr</code> para fazer manipulações, é bonitinho porém não performa bem.</p>

<hr />

<h3 id="filtros-e-subsets">Filtros e subsets</h3>

<hr />

<p>No R devemos evitar o máximo possível fazer laços (<code>for</code> ou <code>while</code>). Temos outras ferramentas para busca e para aplicar funções repetidamente, como as funções da família <code>apply</code>.</p>

<p>Abaixo mostrarei como fazer subsets e filtros.</p>

<p>Image que tenhamos um vetor que gostaríamos de selecionar todos os número maior que um threshold. Podemos utilizar vetores lógicos para fazer essa seleção. Primeiro, vamos demonstrar a criação de um vetor lógico.</p>

<p>Suponha o seguinte vetor:</p>

<pre><code class="language-r">a &lt;- runif(20,1,10)
</code></pre>

<p>Podemos criar um vetor lógico indicador, vamos supor que gostaríamos de marcar todo número menor que 5.</p>

<pre><code class="language-r">vetor_logico &lt;- a &lt; 5
vetor_logico
</code></pre>

<pre><code>##  [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE
## [12]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE
</code></pre>

<p>Agora podemos selecionar posições em <code>a</code> informando quem &lsquo;desligar&rsquo; e a quem retornar, veja:</p>

<pre><code class="language-r">a[vetor_logico]
</code></pre>

<pre><code>## [1] 1.032027 4.410348 4.270202 2.854233 4.884520 3.757685 3.068622 3.834133
## [9] 2.706487
</code></pre>

<pre><code class="language-r"># podemos escrever diretamente
a[a &lt; 5] # quero a, onde a é menor que 5
</code></pre>

<pre><code>## [1] 1.032027 4.410348 4.270202 2.854233 4.884520 3.757685 3.068622 3.834133
## [9] 2.706487
</code></pre>

<p>Agora queremos as posições de <code>a</code> que são menores que 5</p>

<pre><code class="language-r">which(a &lt; 5 )
</code></pre>

<pre><code>## [1]  5 10 11 12 13 14 16 17 20
</code></pre>

<pre><code class="language-r">pos &lt;- which(a &lt; 5)

a[pos]
</code></pre>

<pre><code>## [1] 1.032027 4.410348 4.270202 2.854233 4.884520 3.757685 3.068622 3.834133
## [9] 2.706487
</code></pre>

<p>Podemos também negar um vetor lógico (basicamente pegando o contrário)</p>

<pre><code class="language-r">a[!vetor_logico]
</code></pre>

<pre><code>##  [1] 6.385984 8.736175 7.104037 8.203882 6.494243 6.770594 9.450312
##  [8] 6.899342 7.313048 7.928868 7.744817
</code></pre>

<p>Os vetores lógicos possuem algumas propriedades, por exemplo <code>TRUE = 1</code> e <code>FALSE = 0</code>, então podemos fazer operações com isso. Queremos saber quantos números em <code>a</code> são menores que 5, então podemos fazer assim:</p>

<pre><code class="language-r">sum(a &lt; 5)
</code></pre>

<pre><code>## [1] 9
</code></pre>

<pre><code class="language-r"># ou assim
length(a[a &lt; 5])
</code></pre>

<pre><code>## [1] 9
</code></pre>

<p>Vamos zerar os números menores que 5:</p>

<pre><code class="language-r">a*!vetor_logico
</code></pre>

<pre><code>##  [1] 6.385984 8.736175 7.104037 8.203882 0.000000 6.494243 6.770594
##  [8] 9.450312 6.899342 0.000000 0.000000 0.000000 0.000000 0.000000
## [15] 7.313048 0.000000 0.000000 7.928868 7.744817 0.000000
</code></pre>

<pre><code class="language-r"># ou podemos trocar no proprio objeto

a[a &lt; 5] &lt;- 0 
a
</code></pre>

<pre><code>##  [1] 6.385984 8.736175 7.104037 8.203882 0.000000 6.494243 6.770594
##  [8] 9.450312 6.899342 0.000000 0.000000 0.000000 0.000000 0.000000
## [15] 7.313048 0.000000 0.000000 7.928868 7.744817 0.000000
</code></pre>

<p>Podemos utilizar outros vetores de mesmo tamanho para fazer esse filtro, caso as informações sejam casadas. Vamos supor um <code>data.frame</code> e trabalhar com ele para esses filtros</p>

<pre><code class="language-r">dados &lt;- data.frame(id      = 1:20, #integer
                    letras  = LETTERS[1:20], #character factor
                    numeros = runif(n = 20, min = 1, max = 100) #numeric
                    )
</code></pre>

<p>Queremos as letras da coluna <code>letras</code> que possuam um número da coluna <code>numeros</code> menor que 50.</p>

<pre><code class="language-r">dados$letras[dados$numeros &lt; 50]
</code></pre>

<pre><code>##  [1] B D E F G H K N O P R S T
## Levels: A B C D E F G H I J K L M N O P Q R S T
</code></pre>

<p>Podemos definir um outro <code>data.frame</code> com esse filtro</p>

<pre><code class="language-r">dados1 &lt;- dados[dados$numeros &lt; 50, ]
head(dados1)
</code></pre>

<pre><code>##   id letras   numeros
## 2  2      B  1.518690
## 4  4      D  3.384159
## 5  5      E 23.287412
## 6  6      F 28.360873
## 7  7      G  9.157979
## 8  8      H 41.689610
</code></pre>

<p>Nós usamos muito os vetores lógicos, em todos os lugares. Porém não vou me prolongar aqui, farei isso quando estivermos falando de <code>data.table</code> que é redesenho do <code>data.frame</code>. É utilizando ele que faremos todas as manipulações alá banco de dados, por que ele? por isso:</p>

<p><strong>Máquina do benchmark.</strong></p>

<hr />

<p>Intel&reg; Xeon&reg; CPU E5-2660 v3 @ 2.60GHz</p>

<p>20 CPU CORE</p>

<p>125.8 GB RAM</p>

<hr />

<p><br>
<img src="DT_POWER.png" alt="DT POWER" /></p>

<hr />

<h2 id="laços">Laços</h2>

<hr />

<p>Como disse antes, é bom que evitemos laços ao máximo, mas há momentos que não tem tal possibilidade. Utilizando as funções da família <code>apply</code> podemos substitui praticamente qualquer laço sem o overhead gigantesco (se comparado a outras linguagens) que ele causa. Porém o código fica confuso, é mais complicado pensar na arquitetura da operação, etc. Então há lugares que de fato é proveitoso usar um laço, normalmente quando os planetas se alinham da seguinte forma:</p>

<ul>
<li><p>O passeio é curto: quando é necessário poucas iterações ( menor que 1000).</p></li>

<li><p>A carga é pesada: quando o que se calcula no seu interior é pesado a tal ponto que o overhead gerado pelo loop em si seja irrelevante.</p></li>
</ul>

<p>Por que o número 1000 em poucas iterações? Normalmente quando se precisa de mais iterações do que isso significa que o processo interno é leve, feito em batchs, há outras formas ( e muito melhores) para se lidar com isso do que um loop. Sua pessoa deve usar e abusar da vetorização que o R oferece. Sempre que criar uma função, pense em aplicá-la para o vetor ou matriz inteira e não de forma escalar.</p>

<hr />

<h3 id="for">For</h3>

<hr />

<p>O exemplo que usarei aqui é simples, lembre-se que contas leves não deve ser feito num loop.</p>

<pre><code class="language-r">result &lt;- numeric(20) # sempre que possível pre aloque o vetor de resultados
for(i in 1:20){
  result[i] &lt;- i^2
}
result
</code></pre>

<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100 121 144 169 196 225 256 289
## [18] 324 361 400
</code></pre>

<p>Vamos testar uns tempos?</p>

<pre><code class="language-r">rbenchmark::benchmark(
  &quot;sem_alocar&quot; = {
    result &lt;- c()
    for(i in 1:2000){
      result[i] &lt;- i^2
      }
    },
  &quot;pre_alocado&quot; = {
    result &lt;- numeric(2000) # sempre que possível pre aloque o vetor de resultados
    for(i in 1:2000){
      result[i] &lt;- i^2
      }
    },
  &quot;vetorizado&quot; ={
    (1:2000)^2
    },
  order = &quot;relative&quot;,
  replications = 100,
  columns = c(&quot;test&quot;, &quot;replications&quot;, &quot;relative&quot;, &quot;elapsed&quot;)
  )
</code></pre>

<pre><code>##          test replications relative elapsed
## 3  vetorizado          100        1   0.001
## 2 pre_alocado          100      240   0.240
## 1  sem_alocar          100      273   0.273
</code></pre>

<p>Observe a velocidade relativa, o método <strong>vetorizado</strong> é a base, observe que o método <strong>sem_alocar</strong> é o mais demorado, quantas vezes mais lento? Muito não?!? Agora observe que caso o tamanho do <code>result</code> seja pré alocado é um pouco mais rápido, mas nem de longe comparado com a versão vetorizada.</p>

<p>Temos também as condições que podem ser inseridas num <code>for</code> para quando satisfeita alguma condição específica:</p>

<ul>
<li><p><code>break</code>: Para o loop, saindo dele</p></li>

<li><p><code>next</code>: Pula essa iteração indo para a próxima</p></li>
</ul>

<hr />

<h3 id="while">While</h3>

<hr />

<p>Particularmente acho que da para contar nos dedos de uma mão as vezes em que utilizei o <code>while</code>, acredito que apenas em simulações, esperando algo convergir, etc. Segue o exemplo:</p>

<pre><code class="language-r">result &lt;- numeric(20)
i &lt;- 1
while(i &lt;= 20){
  result[i] &lt;- i
  i &lt;- i+1
}
</code></pre>

<p>As condições <code>next</code>e <code>break</code> também funcionam para o <code>while</code>.</p>

<hr />

<h2 id="if-or-else">IF &hellip; or ELSE!!</h2>

<hr />

<p>A lógica para esses caras é como para qualquer outra linguagem, tem apenas um porém em relação à uma função em específico <code>ifelse</code> que pode facilitar algumas coisas.</p>

<p>A estrutura se inicia por um <code>if</code> com uma determinada condição e logo depois um <code>else</code> opcional. Lembrando que esta condição deve ter comprimento 1, não podendo ser um vetor lógico.</p>

<pre><code class="language-r">a &lt;- 1
if(a == 1){
  &quot;EITA PORRA&quot;
}else{
  &quot;Eita nada&quot;
}
</code></pre>

<pre><code>## [1] &quot;EITA PORRA&quot;
</code></pre>

<pre><code class="language-r">a &lt;- 0
if(a == 1){
  &quot;EITA PORRA&quot;
}else{
  &quot;Eita nada&quot;
}
</code></pre>

<pre><code>## [1] &quot;Eita nada&quot;
</code></pre>

<pre><code class="language-r">a &lt;- 0
if(a != 1){
  &quot;EITA PORRA&quot;
}
</code></pre>

<pre><code>## [1] &quot;EITA PORRA&quot;
</code></pre>

<pre><code class="language-r">a &lt;- 0
if(a &gt; 1){
  &quot;EITA PORRA&quot;
} # nao retorna nada
</code></pre>

<p>A função <code>ifelse</code> permite ser aplicada num vetor lógico.</p>

<pre><code class="language-r">a &lt;- c(T,T,F,T,F,F)

result &lt;- ifelse(test = a,
                 yes  = &quot;EITAAAA&quot;,
                 no   = &quot;EITA NAAOO&quot;
                 )

result
</code></pre>

<pre><code>## [1] &quot;EITAAAA&quot;    &quot;EITAAAA&quot;    &quot;EITA NAAOO&quot; &quot;EITAAAA&quot;    &quot;EITA NAAOO&quot;
## [6] &quot;EITA NAAOO&quot;
</code></pre>

<p>Onde o <code>test</code> é uma condição ou um vetor de condições, como embaixo:</p>

<pre><code class="language-r">a &lt;- runif(10,1,10)

result &lt;- ifelse(test = a &lt; 5,
                 yes  = &quot;EITAAAA&quot;,
                 no   = &quot;EITA NAAOO&quot;
                 )
dados &lt;- data.frame(A         = a,
                    condicoes = a &lt; 5,
                    saida     = result
                    )
dados
</code></pre>

<pre><code>##           A condicoes      saida
## 1  7.588302     FALSE EITA NAAOO
## 2  5.560936     FALSE EITA NAAOO
## 3  4.385240      TRUE    EITAAAA
## 4  2.665477      TRUE    EITAAAA
## 5  2.307467      TRUE    EITAAAA
## 6  2.449290      TRUE    EITAAAA
## 7  2.920070      TRUE    EITAAAA
## 8  8.914990     FALSE EITA NAAOO
## 9  3.729306      TRUE    EITAAAA
## 10 4.224658      TRUE    EITAAAA
</code></pre>

<hr />

<h2 id="funções">Funções</h2>

<hr />

<p>No R tudo são funções, então também temos que fazer nossas próprias funções. Para declarar uma função podemos deixar sem argumentos ou quantos quisermos. Eles podem ter valores default ou não. O ultimo valor a ser retornado que a função irá retornar</p>

<pre><code class="language-r">foo &lt;- function(){
  &quot;eita&quot;
}

foo1 &lt;- function(){
  &quot;eita&quot;
  &quot;eita_porra&quot;
}

foo()
</code></pre>

<pre><code>## [1] &quot;eita&quot;
</code></pre>

<pre><code class="language-r">foo1()
</code></pre>

<pre><code>## [1] &quot;eita_porra&quot;
</code></pre>

<p>Ou ainda podemos deixar explicitado o que será retornado:</p>

<pre><code class="language-r">foo2 &lt;- function(){
  &quot;eita&quot;
  &quot;eita_porra&quot;
  return(&quot;isso aqui sera retornado&quot;)
}

foo2()
</code></pre>

<pre><code>## [1] &quot;isso aqui sera retornado&quot;
</code></pre>

<p>Vamos colocar um argumento e com alguma &ldquo;mastigação&rdquo;:</p>

<pre><code class="language-r">foo3 &lt;- function(argumento){
  result &lt;- paste0(&quot;Mastigando: &quot;, argumento)
  return(result)
}

foo3(argumento = &quot;E I T A !1&quot;)
</code></pre>

<pre><code>## [1] &quot;Mastigando: E I T A !1&quot;
</code></pre>

<p>Mas se tentarmos rodar sem especificar um argumento um erro é retornado. Tente rodar o seguinte comando no seu console.</p>

<pre><code class="language-r">foo3()
</code></pre>

<p>Podemos definir um valor default para este argumento:</p>

<pre><code class="language-r">foo4 &lt;- function(argumento = &quot;Valor Default&quot;){
    result &lt;- paste0(&quot;Mastigando: &quot;, argumento)
    return(result)
}

foo4()
</code></pre>

<pre><code>## [1] &quot;Mastigando: Valor Default&quot;
</code></pre>

<p>NÃO RECOMENDO, mas podemos utilizar uma função para alterar um valor no enviroment global do R. Semelhante a usar uma função que retorna <code>void</code> no c++ e usar ponteiros para alterar informações &ldquo;in place&rdquo;.</p>

<pre><code class="language-r">a &lt;- 1:10
foo5 &lt;- function(){
  a[a &lt; 5] &lt;&lt;- 100
}
</code></pre>

<p>Veja o vetor <code>a</code> como ele é:</p>

<pre><code class="language-r">a
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<p>Vamos rodar a função que modifica inplace por referência.</p>

<pre><code class="language-r">foo5()
</code></pre>

<p>Agora vejamos <code>a</code> novamente.</p>

<pre><code class="language-r">a
</code></pre>

<pre><code>##  [1] 100 100 100 100   5   6   7   8   9  10
</code></pre>

<hr />

<h2 id="loading-75">Loading |======&mdash;| 75%</h2>

<hr />

<p>Dados, vamos aprender a carregar dados. O R tem vários pacotes que nos permitem carregar praticamente qualquer tipo de dado, JSON, csv, txt, Rdata, RDS, até aqueles vindo de programas como excel, stata, access, SPSS, etc. Basta procurar, porém inicialmente nos preocupemos apenas com arquivos csv/txt e dados provindo de bancos.</p>

<hr />

<h3 id="csv-e-txt">CSV e TXT</h3>

<hr />

<p>Temos uma função milagrosa que consegue fazer o parse do arquivo texto e carregar em velocidades astronômicas, esta função também é proveniente do nosso querido e amado <code>data.table</code>. Ele também fornece uma função estupidamente rápida para escrever esses dados em csv ou txt.</p>

<p>Vamos primeiro criar um arquivo txt para podermos treinar os carregamentos, isto implica que primeiro iremos aprender a escrever para depois ler. Já vamos iniciando no <code>data.table</code>.</p>

<pre><code class="language-r">library(data.table) # No R devemos carregar as bibliotecas que iremos utilizar previamente
</code></pre>

<pre><code>## 
## Attaching package: 'data.table'
</code></pre>

<pre><code>## The following objects are masked from 'package:lubridate':
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday,
##     week, yday, year
</code></pre>

<pre><code class="language-r">#####
# Observe que, além de ter carregado a blibioteca,
# eu tambem indiquei na funcao abaixo de qual biblioteca ela provem (utilizando data.table:: antes da funcao)
# este e um passo opcional, mas acredito que para um codigo em producao isso deve ser feito
#####

dados &lt;- data.table::data.table(id      = 1:50000,
                                numeros = runif(50000, 1, 100),
                                letras  = sample(LETTERS, 50000, replace = T)
                                )

## vamos escrever
data.table::fwrite(dados, &quot;dados_example.txt&quot;)
## Vamos rodar um comando  no bash do linux para compactar o arquivo
system(&quot;gzip &lt; dados_example.txt &gt; dados_example.txt.gz&quot;)
</code></pre>

<p>A função <code>fwrite</code> se diz respeito à escrita de um arquivo texto no filesystem. Estou utilizando as configurações default, em que basicamente seleciona-se separador de campos como vírgula, strings que possuem o separador contido nelas estão entre aspas, e a primeira linha se trata do nome das colunas.</p>

<p>Explicando a compressão. A função <code>system</code> executa a string no console bash do linux. O que lemos nessa string? Eu aponto o arquivo .txt para o programa gzip da seguinte forma <code>gzip &lt; dados_example.txt</code> e pego o resultado disso e coloco para o arquivo <code>dados_example.txt.gz</code> usando o apontamento <code>&gt;</code></p>

<p>Vamos verificar os tamanhos dos arquivos.</p>

<pre><code class="language-r">file.size(&quot;dados_example.txt.gz&quot;)/1000000 #mb
</code></pre>

<pre><code>## [1] 0.586925
</code></pre>

<pre><code class="language-r">file.size(&quot;dados_example.txt&quot;)/1000000 #mb
</code></pre>

<pre><code>## [1] 1.233302
</code></pre>

<p>Vamos carregar o arquivo original utilizando a função <code>fread</code> do <code>data.table</code>.</p>

<pre><code class="language-r">dados &lt;- data.table::fread(&quot;dados_example.txt&quot;)
</code></pre>

<p>Carregando pelo arquivo comprimido</p>

<pre><code class="language-r">dados &lt;- data.table::fread(&quot;zcat dados_example.txt.gz&quot;)
</code></pre>

<p>A função <code>fread</code> faz o parse automático do arquivo. Porém é possível adicionar argumentos a mais como qual string é responsável pela separação <code>sep</code>, qual o padrão de decimal utilizado no arquivo <code>dec</code>, e inúmeros outros. Para ver todos os argumentos procure pelo nome da função na aba de <code>help</code> do canto direito da IDE do Rstudio.</p>

<hr />

<h3 id="leitura-do-banco-de-dados">Leitura do banco de dados</h3>

<hr />

<p>Para se ler do banco de dados é necessário primeiramente criar uma conexão com o banco. Esta conexão pode ser feita de várias formas diferentes e cada banco de dados possui uma forma diferente. Para o SQL SERVER utilizaremos o driver ODBC oficial da Microsoft (que já se encontra nessa imagem de docker). Porém não temos um banco de testes aqui, farei um exemplo se conectando ao MySQL de um dos nosso servidores (mas mostrando um código dummy).</p>

<p>É necessário a criação de um objeto de conexão com o banco. Este objeto pode ser criado por inúmeros pacotes diferentes, aqui irei utilizar uma combinação do pacote <code>DBI</code> e <code>RMariaDB</code>. O MariaDB é um fork do próprio MySQL, dos mesmos criadores, que ocorreu quando este foi comprado. O conector do <code>RMariaDB</code> é eficiente e funciona bem com o MySQL.</p>

<pre><code class="language-r">## Carregando pacotes necessarios
library(DBI)
library(RMariaDB)

## Criando objeto de conexao
con &lt;- DBI::dbConnect(RMariaDB::MariaDB(),
                      user='SUPER USUARIO', 
                      password='SENHA FODA BAGARAI',
                      #dbname= database.,
                      dbname='DW_name_cliente',
                      host='192.168.134.63',
                      encoding = &quot;latin1&quot;,
                      bigint = &quot;character&quot;
                      )
</code></pre>

<p>Agora que temos o objeto de conexão <code>con</code>, iremos utilizá-lo como operador para passar requisições para o banco. Vamos mudar uma configuração do banco, aumentar o limite de tempo para que ele corte o nossa conexão inexplicável.</p>

<pre><code class="language-r">DBI::dbExecute(con, 
               paste0(&quot;SET GLOBAL connect_timeout = 600000;&quot;)
               )
</code></pre>

<p>O que fazemos? Utilizamos a função <code>dbExecute</code> e passamos o objeto de conexão com o qual ela irá lidar. Após isso passamos uma string que será executada, apesar de eu ter me utilizado da função <code>paste0</code>, poderíamos ter passado a string diretamente. A função <code>paste0</code> nos permite compor strings utilizando valores de outros objetos.</p>

<p>Vamos agora executar uma query para puxar os dados para um objeto do R.</p>

<pre><code class="language-r">query &lt;- &quot;SELECT  *
          FROM  T_FatoUtilizacao WHERE DtUtilizacao &gt;= '2018-01-01' AND DtUtilizacao &lt;= '2018-12-31';&quot;

dados &lt;- DBI::dbGetQuery(con, query) %&gt;% 
  data.table::setDT()
</code></pre>

<p>Primeiro, crio um objeto com a consulta que será aplicada, depois utilizo da função <code>dbGetQuery</code> que executará a query armazenada no objeto <code>query</code> na conexão <code>con</code>. Após isso, redireciono a saída delas função com o operador <code>%&gt;%</code> para a função <code>setDT</code> que irá transformar este objeto, in-place, num objeto data.table.</p>

<hr />

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="../../../tutoriais/r_basico/r_datatable/" rel="prev">R Data Table</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Dec 20, 2019</p>

          


          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="../../../js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
